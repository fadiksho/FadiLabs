@page "/StatusCode/{code:int}"

@using Microsoft.AspNetCore.Diagnostics
@using Shared.Components.Components.Shared
@using Shared.Components.Components.Static

@attribute [ExcludeFromInteractiveRouting]

<StatusCodeRedirect Code="@Code" Path="@OriginalPathAndQuery" />

@code {
  [Parameter]
  public int Code { get; set; }

  public string? OriginalPathAndQuery { get; set; }

  [CascadingParameter]
  public HttpContext HttpContext { get; set; } = default!;

  protected override void OnInitialized()
  {
    var statusCodeReExecuteFeature =
            HttpContext.Features.Get<IStatusCodeReExecuteFeature>();

    if (statusCodeReExecuteFeature is not null)
    {
      OriginalPathAndQuery = $"{statusCodeReExecuteFeature.OriginalPathBase}"
                           + $"{statusCodeReExecuteFeature.OriginalPath}"
                           + $"{statusCodeReExecuteFeature.OriginalQueryString}";
    }
  }
}
